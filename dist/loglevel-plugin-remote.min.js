!function(e,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.remote=n.exports}}(this,function(e,t){"use strict";function n(e){try{return JSON.stringify(e)}catch(e){if(!f)try{var t={};t.a=t,JSON.stringify(t)}catch(e){f=e.message}if(e.message===f)return"[Circular]";throw e}}function r(e){if(!Object.getOwnPropertyDescriptor||!Object.getPrototypeOf)return Object.prototype.toString.call(e).slice(8,-1);for(;e;){var t=Object.getOwnPropertyDescriptor(e,"constructor");if(void 0!==t&&"function"==typeof t.value&&""!==t.value.name)return t.value.name;e=Object.getPrototypeOf(e)}return""}function o(e){var t="",o=0;return e.length>1&&"string"==typeof e[0]&&(t=(t=e[0].replace(/(%?)(%([sdjo]))/g,function(t,i,s,a){if(!i){var c=e[o+=1],u="";switch(a){case"s":u+=c;break;case"d":u+=+c;break;case"j":u=n(c);break;case"o":var f=n(c);"{"!==f[0]&&"["!==f[0]&&(f="<"+f+">"),u=r(c)+f}return u}return t})).replace(/%{2,2}/g,"%"),o+=1),e.length>o&&(t&&(t+=" "),t+=e.slice(o).join(" ")),t}function i(){for(var e={},t=0;t<arguments.length;t+=1){var n=Object(arguments[t]);for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}function s(){try{throw new Error}catch(e){return e.stack}}function a(e,t){var n=[];this.length=function(){return n.length},this.push=function(r){t&&e&&n.length>=e&&n.shift(),n.push(r[0])},this.send=function(){var e=n;return n=[],e}}function c(){var e=this,t=window?window.localStorage:void 0;if(t){var n=void 0,r=void 0,o=void 0;try{n=t.getItem.bind(t),r=t.setItem.bind(t),o=t.removeItem.bind(t);var i=u+"-test";r(i,i),o(i)}catch(e){return}var s=u+"-queue",a=u+"-sent",c=[],f=n(a);f&&(c=JSON.parse(f),o(a));var l=n(s);l&&(c=c.concat(JSON.parse(l))),r(s,JSON.stringify(c)),this.length=function(){return c.length},this.push=function(e){if(e.length)for(c=c.concat(e);;){var t=JSON.stringify(c);try{r(s,t);break}catch(t){c.splice(0,e.length)}}},this.shift=function(e){var t=c.splice(0,e);return r(s,JSON.stringify(c)),t},this.send=function(t){var n=e.shift(t);return r(a,JSON.stringify(n)),n},this.confirm=function(){o(a)},this.unshift=function(e){if(e.length){var t=e.concat(c),n=JSON.stringify(t);try{r(s,n),c=t}catch(e){}}}}}Object.defineProperty(t,"__esModule",{value:!0});var u="loglevel-plugin-remote",f=void 0,l={url:"/logger",token:"",timeout:0,interval:100,backoff:function(e){var t=2*e;return t>3e4&&(t=3e4),t+=.1*t*Math.random()},capacity:0,persist:"default",trace:["trace","warn","error"],depth:0,json:!1,timestamp:function(){return(new Date).toISOString()}},p=!!s(),g=void 0,v=void 0,d=void 0,remote={apply:function(e,t){function r(){function e(e){y=!0,setTimeout(function(){y=!1,r()},O),e||(O=t.backoff(O),"never"!==t.persist&&j!==h&&(h.unshift(b.messages),h.confirm(),b={messages:[]},h.push(m.send()),j=h))}if(!y&&!w){if(!b.messages.length)if(h.length())b.messages=h.send(h.length());else{if(!m.length())return;b.messages=m.send()}if(w=!0,!b.content)if(t.json)b.content=n({messages:b.messages});else{var o="";b.content="",b.messages.forEach(function(e){var t=e.stacktrace?"\n"+e.stacktrace:"";b.content+=""+o+e.message+t,o="\n"})}var i=new window.XMLHttpRequest;i.open("POST",t.url,!0),i.setRequestHeader("Content-Type",f),t.token&&i.setRequestHeader("Authorization",u);var s=void 0;t.timeout&&(s=setTimeout(function(){w=!1,i.abort(),e()},t.timeout)),i.onreadystatechange=function(){4===i.readyState&&(w=!1,clearTimeout(s),200===i.status?(O=t.interval,b={messages:[]},h.confirm(),"always"!==t.persist&&(j=m),e(!0)):e())},i.send(b.content)}}if(!e||!e.getLogger)throw new TypeError("Argument is not a root loglevel object");if(g)throw new Error("You can assign a plugin only one time");if(!window||!window.XMLHttpRequest)return e;g=e;var u="Bearer "+(t=i(l,t)).token,f=t.json?"application/json":"text/plain",h=new c;h.push||(t.persist="never");var m=new a(t.capacity,"never"===t.persist),w=!1,y=!1,O=t.interval,b={messages:[]},j="always"===t.persist?h:m;return v=v||e.methodFactory,d=function(e,n,i){var a=v(e,n,i),c=p&&t.trace.some(function(t){return t===e});return function(){for(var n=arguments.length,u=Array(n),f=0;f<n;f++)u[f]=arguments[f];var l=t.timestamp(),p=c?s():"";if(p){var g=p.split("\n");g.splice(0,t.depth+3),p=g.join("\n")}j.push([{message:o(u),level:e,logger:i,timestamp:l,stacktrace:p}]),r(),a.apply(void 0,u)}},e.methodFactory=d,e.setLevel(e.getLevel()),e},disable:function(){if(!g)throw new Error("You can't disable a not appled plugin");if(d!==g.methodFactory)throw new Error("You can't disable a plugin after appling another plugin");g.methodFactory=v,v=void 0,(g=void 0).setLevel(g.getLevel())}},h=window?window.remote:void 0;remote.noConflict=function(){return window&&window.remote===remote&&(window.remote=h),remote},t.default=remote,e.exports=t.default});