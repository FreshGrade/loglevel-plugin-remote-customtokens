!function(e,t){if("function"==typeof define&&define.amd)define(["module","exports"],t);else if("undefined"!=typeof exports)t(module,exports);else{var n={exports:{}};t(n,n.exports),e.remote=n.exports}}(this,function(e,t){"use strict";function n(e){try{return JSON.stringify(e)}catch(e){if(!i)try{var t={};t.a=t,JSON.stringify(t)}catch(e){i=e.message}if(e.message===i)return"[Circular]";throw e}}function r(e){if(!Object.getOwnPropertyDescriptor||!Object.getPrototypeOf)return Object.prototype.toString.call(e).slice(8,-1);for(;e;){var t=Object.getOwnPropertyDescriptor(e,"constructor");if(void 0!==t&&"function"==typeof t.value&&""!==t.value.name)return t.value.name;e=Object.getPrototypeOf(e)}return""}function o(e){var t="",o=0;return e.length>1&&"string"==typeof e[0]&&(t=(t=e[0].replace(/(%?)(%([sdjo]))/g,function(t,a,s,i){if(!a){var c=e[o+=1],u="";switch(i){case"s":u+=c;break;case"d":u+=+c;break;case"j":u=n(c);break;case"o":var f=n(c);"{"!==f[0]&&"["!==f[0]&&(f="<"+f+">"),u=r(c)+f}return u}return t})).replace(/%{2,2}/g,"%"),o+=1),e.length>o&&(t&&(t+=" "),t+=e.slice(o).join(" ")),t}function a(){for(var e={},t=0;t<arguments.length;t+=1){var n=Object(arguments[t]);for(var r in n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r])}return e}function s(){try{throw new Error}catch(e){return e.stack}}Object.defineProperty(t,"__esModule",{value:!0});var i=void 0,c={url:"/logger",token:"",timeout:0,interval:100,backoff:function(e){var t=2*e;return t>3e4&&(t=3e4),t+=.1*t*Math.random()},capacity:0,trace:["trace","warn","error"],depth:0,json:!1,timestamp:function(){return(new Date).toISOString()}},u=!!s(),f=!1,remote={apply:function(e,t){function r(){function e(e){g=!0,setTimeout(function(){g=!1,r()},m),e||(m=t.backoff(m))}if(!g&&!p&&(d.length||v.messages.length)){if(p=!0,v.messages.length||(v.messages=d,d=[]),!v.content)if(t.json)v.content=n({messages:v.messages});else{var o="";v.content="",v.messages.forEach(function(e){var t=e.stacktrace?"\n"+e.stacktrace:"";v.content+=""+o+e.message+t,o="\n"})}var a=new window.XMLHttpRequest;a.open("POST",t.url,!0),a.setRequestHeader("Content-Type",l),t.token&&a.setRequestHeader("Authorization",i);var s=void 0;t.timeout&&(s=setTimeout(function(){p=!1,a.abort(),e()},t.timeout)),a.onreadystatechange=function(){4===a.readyState&&(p=!1,clearTimeout(s),200===a.status?(m=t.interval,v={messages:[]},e(!0)):e())},a.send(v.content)}}if(!e||!e.getLogger)throw new TypeError("Argument is not a root loglevel object");if(f)throw new TypeError("You can assign a plugin only one time");if(!window||!window.XMLHttpRequest)return e;f=!0;var i="Bearer "+(t=a(c,t)).token,l=t.json?"application/json":"text/plain",p=!1,g=!1,m=t.interval,d=[],v={messages:[]},h=e.methodFactory;return e.methodFactory=function(e,n,a){var i=h(e,n,a),c=u&&t.trace.some(function(t){return t===e});return function(){for(var n=arguments.length,u=Array(n),f=0;f<n;f++)u[f]=arguments[f];t.capacity&&d.length+v.messages.length>=t.capacity&&(v.messages.length?(v.messages.shift(),v.content=""):d.shift());var l=t.timestamp(),p=c?s():"";if(p){var g=p.split("\n");g.splice(0,t.depth+3),p=g.join("\n")}d.push({message:o(u),level:e,logger:a,timestamp:l,stacktrace:p}),r(),i.apply(void 0,u)}},e.setLevel(e.getLevel()),e}},l=window?window.remote:void 0;remote.noConflict=function(){return window&&window.remote===remote&&(window.remote=l),remote},t.default=remote,e.exports=t.default});